var hashes = [
    'trang-chu',
    'gioi-thieu',
    'tinh-nang-noi-bat',
    'lien-ket-the',
    'tin-tuc',
    'faq',
    'gop-y',
    'quy-dinh-dich-vu'];
var sScroll, hash, popSize, isNew;
$(document).ready(function() {
});

function loadHome() {
    popSize = {tinhnangnoibat: 8, tintuc: 4, faq: 6};
    sScroll = new SmoothScroll('a[href*="#"]', {
        speed: 500, before: function() {
            $('a.page-scroll').removeClass('active');
        }, after: function() {
            $('a.page-scroll[href=\'' + window.location.hash + '\']').
                addClass('active');
        }
    });
    $('a[href=\'#trang-chu\']').on('click', function() {
        $('a.page-scroll').removeClass('active');
        $('a.page-scroll[href=\'#trang-chu\']').addClass('active');
        $('.navbar-collapse').collapse('hide');
        window.scrollTo(0, 0);
    });
    var b = window.location.hash.substr(1).toLowerCase();
    if (hashes.indexOf(b) < 0) {
        hash = 'trang-chu';
    } else {
        hash = b;
    }
    var a = document.querySelector('#' + hash);
    if (a !== null) {
        $('a.page-scroll[href=\'' + window.location.hash + '\']').
            addClass('active');
        setTimeout(function() {
            sScroll.animateScroll(a);
        }, 500);
    } else {
        $('a.page-scroll[href=\'#trang-chu\']').addClass('active');
    }
}

function loadPopup() {
    $('.linegreen1').addClass('hide');
    $('.popup-detail').on('click', function() {
        if ($(this).next().hasClass('hide')) {
            $('.linegreen1').addClass('hide');
            $(this).next().removeClass('hide');
            $('div.bxpopup1_r').scrollTop(0, 0);
            $('div.bxpopup1_r').
                animate({scrollTop: ($(this).offset().top - 57)}, 500);
        }
    });
}

function validPopup(a, b) {
    if ($.isNumeric(b) && b > 0 && hashes.indexOf(a) >= 0) {
        switch (a) {
            case 'tinh-nang-noi-bat':
                return b <= popSize.tinhnangnoibat;
                break;
            case 'tin-tuc':
                return b <= popSize.tintuc;
                break;
            case 'faq':
                return b <= popSize.faq;
                break;
        }
    }
    return false;
}

function showPopup(type, id, question) {
    if (validPopup(type, id)) {
        var b = BASE_URL + 'popup/' + type + '-' + id + '.html';

        // var b = BASE_URL + "popup/?hash=" + type + "&id=" + id;
        // if (typeof question !== "undefined" && $.isNumeric(question)) {
        //     b += "&question=" + question
        // }

        window.location.href = b;
    }
}

function showPopupDetail(a) {
    if ($.isNumeric(a) && typeof $('.popup-detail')[a - 1] !== 'undefined') {
        $('.popup-detail')[a - 1].click();
    }
}

function submitFormFeedback() {
    var a = true;
    var b = getInputValue('fullname'), d = getInputValue('email'),
        f = getInputValue('title'),
        e = getInputValue('content'), c = getInputValue('captcha');
    $('.bx_error').addClass('hide');
    $('#fullname').removeClass('error_input');
    $('#email').removeClass('error_input');
    $('#title').removeClass('error_input');
    $('#content').removeClass('error_input');
    $('#captcha').removeClass('error_input');
    if (!isValidLength(b, 2)) {
        a = false;
        showInputError('fullname');
    }
    if (!isValidLength(d, 10) || !validateEmail(d)) {
        a = false;
        showInputError('email');
    }
    if (!isValidLength(f, 3)) {
        a = false;
        showInputError('title');
    }
    if (!isValidLength(e, 10)) {
        a = false;
        showInputError('content');
    }
    if (!isValidLength(c, 8)) {
        a = false;
        showInputError('captcha');
    }
    if (a) {
        $('form#frmFeedback').submit();
    }
}

function showInputError(a) {
    $('#' + a).addClass('error_input');
    $('#' + a).next('.bx_error').removeClass('hide');
    $('#' + a).focus();
}

function getInputValue(a) {
    if (typeof $('#' + a) !== 'undefined') {
        return $('#' + a).val().trim();
    }
    return '';
}

function isValidLength(a, b) {
    return a.length >= b;
}

function validateEmail(a) {
    if (a === '') {
        return false;
    }
    var b = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return b.test(a);
};